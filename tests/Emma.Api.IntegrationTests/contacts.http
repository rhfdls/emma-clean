@baseUrl = http://localhost:5073

### 1) Dev token (Development only)
# @name devtoken
POST {{baseUrl}}/api/auth/dev-token
Content-Type: application/json

{
  "email": "owner@test.dev",
  "organizationName": "OrgA"
}

### Extract token and userId
@token = {{devtoken.response.body.$.token}}
@userId = {{devtoken.response.body.$.userId}}

### 2) Create contact (provider optional fields allowed)
# @name create_contact
POST {{baseUrl}}/api/contacts
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "firstName": "Ada",
  "lastName": "Lovelace",
  "primaryEmail": "ada@example.com",
  "relationshipState": "ServiceProvider",
  "companyName": "Lovelace & Co.",
  "licenseNumber": "ON-123456",
  "isPreferred": true,
  "website": "https://lovelace.example"
}

### Capture contact id
@contactId = {{create_contact.response.body.$.id}}

### 3) Assign owner (Owner/Admin or current Owner only)
POST {{baseUrl}}/api/contacts/{{contactId}}/assignments
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "assigneeUserId": "{{userId}}",
  "isPrimary": true
}

### 4) Update business/provider fields
PUT {{baseUrl}}/api/contacts/{{contactId}}
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "companyName": "Lovelace & Co.",
  "website": "https://lovelace-updated.example",
  "isPreferred": false
}

### 5) Read contact
GET {{baseUrl}}/api/contacts/{{contactId}}
Authorization: Bearer {{token}}

### Ask dev agent for suggest-followup
POST {{baseUrl}}/api/agent/suggest-followup
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "contactId": "{{contactId}}"
}
